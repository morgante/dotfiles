if { true <&3 } 2>/dev/null; then
  _fd3_tmpfile="/var/tmp/zshenv-fd3.$$.tmp"
  echo "fd3 present"
  command cat <&3 >| "${_fd3_tmpfile}" 2>/dev/null
  unset _fd3_tmpfile
fi

# Log commands and timestamps to /var/tmp
_cmd_log_file="/var/tmp/zsh_commands.log"
_launch_log_file="/var/tmp/zsh_launches.log"
echo "[$(date '+%Y-%m-%d %H:%M:%S')] zsh launched (PID: $$, args: $@)" >> "$_launch_log_file"
preexec() {
  echo "[$(date '+%Y-%m-%d %H:%M:%S')] (PID: $$) $1" >> "$_cmd_log_file"
}